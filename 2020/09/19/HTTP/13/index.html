<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>HTTP 查漏补缺 - heptaluan&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="本章记录的是一些 HTTP 相关内容的补充，偏向于查漏补缺，主要是一些平常遇到或是看到过的知识点，面试题之类的，在这里简单的整理汇总一下，一方面补充些专业知识，另一方面也是方便以后查询或是复习，更多相关内容可以参考 计算机网络知识梳理 和 前端知识体系整理">
<meta name="keywords" content="HTTP">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP 查漏补缺">
<meta property="og:url" content="http://yoursite.com/2020/09/19/HTTP/13/index.html">
<meta property="og:site_name" content="heptaluan&#39;s blog">
<meta property="og:description" content="本章记录的是一些 HTTP 相关内容的补充，偏向于查漏补缺，主要是一些平常遇到或是看到过的知识点，面试题之类的，在这里简单的整理汇总一下，一方面补充些专业知识，另一方面也是方便以后查询或是复习，更多相关内容可以参考 计算机网络知识梳理 和 前端知识体系整理">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/13.jpg">
<meta property="og:updated_time" content="2020-09-22T07:53:18.518Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTP 查漏补缺">
<meta name="twitter:description" content="本章记录的是一些 HTTP 相关内容的补充，偏向于查漏补缺，主要是一些平常遇到或是看到过的知识点，面试题之类的，在这里简单的整理汇总一下，一方面补充些专业知识，另一方面也是方便以后查询或是复习，更多相关内容可以参考 计算机网络知识梳理 和 前端知识体系整理">
<meta name="twitter:image" content="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/13.jpg">







<link rel="icon" href="https://gitee.com/heptaluan/backups/raw/master/cdn/favicon.ico">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
<script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?f0399d35b846ccd84f70acc7b232fb2e";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>

    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-2-column">
    <!-- fork me on github -->
<a id="forkMe" style="position: fixed;top: 0;right: 0;z-index: 31" href="https://github.com/heptaluan" target="_blank">
    <svg style="color: #fff;fill: #a0a1a7;height: 80px;width: 80px;" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg>
</a>

<nav class="navbar navbar-main">
    <div class="container">
        <!-- <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="HTTP 查漏补缺" height="28">
            
            </a>
        </div> -->

        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">Home</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/target">Target</a>
                
                <a class="navbar-item" href="https://heptaluan.github.io/demos/">Demos</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fa fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main"><div class="card">
    
    <div class="card-image">
        <span class="image is-7by1">
            <img class="thumbnail" src="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/13.jpg" alt="HTTP 查漏补缺">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <div class="level-item has-text-grey">2020-09-19</div>
                <!-- <time class="level-item has-text-grey" datetime="2020-09-18T16:00:00.000Z">2020-09-19</time> -->
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/HTTP/">HTTP</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 小时 读完 (大约 9313 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                HTTP 查漏补缺
            
        </h1>
        <div class="content">
            <p>本章记录的是一些 <code>HTTP</code> 相关内容的补充，偏向于查漏补缺，主要是一些平常遇到或是看到过的知识点，面试题之类的，在这里简单的整理汇总一下，一方面补充些专业知识，另一方面也是方便以后查询或是复习，更多相关内容可以参考 <a href="https://heptaluan.github.io/2020/08/08/HTTP/00/" target="_blank" rel="noopener">计算机网络知识梳理</a> 和 <a href="https://heptaluan.github.io/target/" target="_blank" rel="noopener">前端知识体系整理</a></p>
<a id="more"></a>


<h2 id="HTTP-协议优缺点"><a href="#HTTP-协议优缺点" class="headerlink" title="HTTP 协议优缺点"></a>HTTP 协议优缺点</h2><ul>
<li><code>HTTP</code> 特点<ul>
<li>灵活可扩展，一个是语法上只规定了基本格式，空格分隔单词，换行分隔字段等，另外一个就是传输形式上不仅可以传输文本，还可以传输图片，视频等任意数据</li>
<li>请求/响应 模式，通常而言，就是一方发送消息，另外一方要接受消息，或者是做出相应等</li>
<li>可靠传输，<code>HTTP</code> 是基于 <code>TCP/IP</code>，<code>TCP</code> 提供可靠的字节流服务，<code>IP</code> 协议的作用是把各种数据传送给对方</li>
</ul>
</li>
<li><code>HTTP</code> 缺点<ul>
<li>无连接，限制每次连接只处理一个请求，服务器处理完客户的请求，并收到客户的应答后，即断开连接</li>
<li>无状态，对于事务处理没有记忆能力，即服务器不知道客户端是什么状态</li>
<li>明文传输，协议里的报文不使用二进制数据，而是文本形式，这让 <code>HTTP</code> 的报文信息暴露给了外界，给攻击者带来了便利</li>
<li>队头阻塞，当 <code>HTTP</code> 开启长连接时，共用一个 <code>TCP</code> 连接，当某个请求时间过长时，其他的请求只能处于阻塞状态，这就是队头阻塞问题</li>
</ul>
</li>
</ul>
<h2 id="HTTP-协议各版本差异"><a href="#HTTP-协议各版本差异" class="headerlink" title="HTTP 协议各版本差异"></a>HTTP 协议各版本差异</h2><ul>
<li><code>HTTP/0.9</code><ul>
<li><code>1991</code> 年发布的原型版本，功能简陋，只有一个命令 <code>GET</code>，只支持纯文本内容</li>
</ul>
</li>
<li><code>HTTP/1.0</code><ul>
<li>任何格式的内容都可以发送，另外还引入了 <code>POST</code> 命令和 <code>HEAD</code> 命令</li>
<li><code>HTTP</code> 请求和回应的格式改变，除了数据部分，每次通信都必须包括头信息，用来描述一些元数据</li>
<li>只使用请求头中的 <code>If-Modified-Since</code> 和 <code>Expires</code> 字段作为缓存失效的标准</li>
<li>不支持断点续传，也就是说，每次都会传送全部的页面和数据</li>
<li>通常每台计算机只能绑定一个 <code>IP</code>，所以请求消息中的 <code>URL</code> 并没有传递主机名</li>
</ul>
</li>
<li><code>HTTP/1.1</code><ul>
<li>引入了持久连接<ul>
<li><code>TCP</code> 连接默认不关闭，可以被多个请求复用，不用声明 <code>Connection: keep-alive</code>，长连接的连接时长可以通过请求头中的 <code>keep-alive</code> 来设置</li>
</ul>
</li>
<li>引入了管线机制（<code>Pipelining</code>）<ul>
<li>在同一个 <code>TCP</code> 连接里，客户端可以同时发送多个请求</li>
</ul>
</li>
<li>新增缓存控制标头<ul>
<li>添加了 <code>E-tag</code>，<code>If-Unmodified-Since</code>，<code>If-Match</code>，<code>If-None-Match</code> 等缓存控制标头来控制缓存失效</li>
</ul>
</li>
<li>支持断点续传<ul>
<li>通过使用请求头中的 <code>Range</code> 来实现</li>
</ul>
</li>
<li>使用了虚拟网络<ul>
<li>在一台物理服务器上可以存在多个虚拟主机，并且它们共享一个 <code>IP</code> 地址</li>
</ul>
</li>
<li>新增方法 <code>PUT</code>、<code>PATCH</code>、<code>OPTIONS</code>、<code>DELETE</code></li>
</ul>
</li>
<li><code>HTTP/2</code><ul>
<li>二进制分帧<ul>
<li>采用二进制格式，这样报文格式就被拆分为一个个乱序的二进制帧，用 <code>Headers</code> 帧存放头部字段，<code>Data</code> 帧存放请求体数据等，因为不需要排队等待，一定程度上解决了队头阻塞问题</li>
</ul>
</li>
<li>头部压缩<ul>
<li><code>HTTP/1.1</code> 版本会出现 <code>User-Agent/Cookie/Accept/Server/Range</code> 等字段可能会占用几百甚至几千字节，而 <code>Body</code> 却经常只有几十字节，导致头部偏重，<code>HTTP/2</code> 使用 <code>HPACK</code> 算法进行压缩</li>
</ul>
</li>
<li>多路复用<ul>
<li>复用 <code>TCP</code> 连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，且不用按顺序一一对应，一定程度上解决了队头阻塞的问题</li>
</ul>
</li>
<li>服务器推送<ul>
<li>允许服务器未经请求，主动向客户端发送资源，即服务器推送</li>
</ul>
</li>
<li>请求优先级<ul>
<li>可以设置数据帧的优先级，让服务端先处理重要资源，优化用户体验</li>
</ul>
</li>
</ul>
</li>
<li><code>HTTP/3</code><ul>
<li><code>QUIC</code> 协议<ul>
<li>运行在 <code>QUIC</code> 之上的 <code>HTTP</code> 协议被称为 <code>HTTP/3</code>，<code>QUIC</code> 协议基于 <code>UDP</code> 实现，同时也整合了 <code>TCP</code>、<code>TLS</code> 和 <code>HTTP/2</code> 的优点，并加以优化</li>
</ul>
</li>
<li>零 <code>RTT</code> 建立连接<ul>
<li>首次连接只需要 <code>1 RTT</code>，后面的连接更是只需 <code>0 RTT</code>，意味着客户端发给服务端的第一个包就带有请求数据</li>
</ul>
</li>
<li>连接迁移<ul>
<li><code>QUIC</code> 连接不以四元组（源 <code>IP</code>、源端口、目的 <code>IP</code>、目的端口）作为标识，而是使用一个 <code>64</code> 位的随机数，这个随机数被称为 <code>Connection ID</code>，即使 <code>IP</code> 或者端口发生变化，只要 <code>Connection ID</code> 没有变化，那么连接依然可以维持</li>
</ul>
</li>
<li>多路复用<ul>
<li><code>QUIC</code> 的传输单元是 <code>Packet</code>，加密单元也是 <code>Packet</code>，整个加密、传输、解密都基于 <code>Packet</code>，这样就能避免 <code>TLS</code> 的队头阻塞问题</li>
<li><code>QUIC</code> 基于 <code>UDP</code>，<code>UDP</code> 的数据包在接收端没有处理顺序，即使中间丢失一个包，也不会阻塞整条连接，其他的资源会被正常处理</li>
</ul>
</li>
<li>改进的拥塞控制<ul>
<li>热插拔，<code>TCP</code> 中如果要修改拥塞控制策略，需要在系统层面进行操作，<code>QUIC</code> 修改拥塞控制策略只需要在应用层操作，并且 <code>QUIC</code> 会根据不同的网络环境、用户来动态选择拥塞控制算法</li>
<li>前向纠错 <code>FEC</code>，使用前向纠错（<code>FEC</code>，<code>Forward Error Correction</code>）技术增加协议的容错性，一段数据被切分为 <code>10</code> 个包后，依次对每个包进行异或运算，运算结果会作为 <code>FEC</code> 包与数据包一起被传输，如果不幸在传输过程中有一个数据包丢失，那么就可以根据剩余 <code>9</code> 个包以及 <code>FEC</code> 包推算出丢失的那个包的数据</li>
<li>单调递增的 <code>Packet Number</code>，与 <code>TCP</code> 的 <code>Sequence Number</code> 不同的是，<code>Packet Number</code> 严格单调递增，如果 <code>Packet N</code> 丢失了，那么重传时 <code>Packet</code> 的标识不会是 <code>N</code>，而是比 <code>N</code> 大的数字，比如 <code>N + M</code>，这样发送方接收到确认消息时就能方便地知道 <code>ACK</code> 对应的是原始请求还是重传请求</li>
<li>更多的 <code>ACK</code> 块，<code>QUIC</code> 最多可以捎带 <code>256</code> 个 <code>ACK block</code>，在丢包率比较严重的网络下，更多的 <code>ACK block</code> 可以减少重传量，提升网络效率</li>
</ul>
</li>
<li>流量控制<ul>
<li><code>TCP</code> 会对每个 <code>TCP</code> 连接进行流量控制，而 <code>QUIC</code> 只需要建立一条连接，在这条连接上同时传输多条 <code>Stream</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="队头阻塞问题"><a href="#队头阻塞问题" class="headerlink" title="队头阻塞问题"></a>队头阻塞问题</h2><p>关于队头阻塞问题，其实在整理 <code>HTTP/1.1</code>，<code>HTTP/2</code> 和 <code>HTTP/3</code> 相关内容的时候都有所涉及，但是可能是东一点西一点分散在各处，所以在这里就简单的汇总和梳理一下</p>
<h4 id="什么是队头阻塞？"><a href="#什么是队头阻塞？" class="headerlink" title="什么是队头阻塞？"></a>什么是队头阻塞？</h4><p>对于每一个 <code>HTTP</code> 请求而言，这些任务是会被放入一个任务队列中串行执行的，一旦队首任务请求太慢时，就会阻塞后面的请求处理，这就是 <code>HTTP</code> 队头阻塞问题，队头阻塞会导致带宽无法被充分利用，以及后续健康请求被阻塞，假设有五个请求同时发出，如下图</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/11-01.png" alt></p>
<p>在第一个请求没有收到回复之前，后续从应用层发出的请求只能排队，请求 <code>2，3，4，5</code> 只能等待请求 <code>1</code> 的响应回来之后才能逐个发出，网络通畅的时候性能影响不大，一旦请求 <code>1</code> 因为什么原因没有抵达服务器，或者响应因为网络阻塞没有及时返回，影响的就是所有后续请求</p>
<h4 id="如何解决"><a href="#如何解决" class="headerlink" title="如何解决"></a>如何解决</h4><p>在 <code>HTTP/1.1</code> 当中，为了解决队头阻塞带来的延迟，协议设计者设计了一种新的 <code>HTTP</code> 管线化机制（<code>pipelining</code>），管线化的流程图可以用下图表示</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/11-04.png" alt></p>
<p>和之前相比最大的差别是，请求 <code>2，3，4，5</code> 不需要等待请求 <code>1</code> 的响应返回之后才发出，而是几乎在同一时间就把请求发向了服务器，<code>2，3，4，5</code> 及所有后续共用该连接的请求节约了等待的时间，极大的降低了整体延迟，下图可以清晰的看出这种新机制对延迟的改变</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/11-05.png" alt></p>
<p>不过管线化并不是完美的，它也存在不少缺陷</p>
<ul>
<li>管线化只能适用于 <code>HTTP/1.1</code> ，一般来说，支持 <code>HTTP/1.1</code> 的服务端都要求支持管线化</li>
<li>只有幂等的请求（<code>GET</code>，<code>HEAD</code>）能使用管线化，非幂等请求比如 <code>POST</code> 不能使用，因为请求之间可能会存在先后依赖关系</li>
<li>队头阻塞并没有完全得到解决，服务端的响应还是要求依次返回，遵循 <code>FIFO</code>（<code>first in first out</code>）原则，也就是说如果请求 <code>1</code> 的响应没有回来，<code>2，3，4，5</code> 的响应也不会被送回来</li>
<li>绝大部分的 <code>HTTP</code> 代理服务器不支持管线化</li>
</ul>
<p>正是因为有这么多的问题，各大浏览器厂商要么是根本就不支持管线化，要么就是默认关掉了管线化机制，而且启用的条件十分苛刻，可以参考 <code>Chrome</code> 对于管线化的 <a href="https://www.chromium.org/developers/design-documents/network-stack/http-pipelining" target="_blank" rel="noopener">问题描述</a></p>
<p>接下来，在 <code>HTTP/2</code> 当中提出了多路复用（<code>multiplexing</code>）的解决方案（源自 <code>SPDY</code>），多路复用允许同时通过单一的 <code>HTTP/2</code> 连接发起多重的 请求/响应 消息，众所周知在 <code>HTTP/1.1</code> 协议中，浏览器客户端在同一时间，针对同一域名下的请求有一定数量限制，超过限制数目的请求会被阻塞，也就是如果想并发多个请求，必须使用多个 <code>TCP</code> 链接</p>
<p>这也是为何一些站点会有多个静态资源 <code>CDN</code> 域名的原因之一，目的就是变相的解决浏览器针对同一域名的请求限制阻塞问题，而 <code>HTTP/2</code> 的多路复用（<code>Multiplexing</code>）则允许同时通过单一的 <code>HTTP/2</code> 连接发起多重的 请求/响应 消息</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/11-15.png" alt></p>
<p>因此 <code>HTTP/2</code> 可以很容易的去实现多流并行而不用依赖建立多个 <code>TCP</code> 连接，<code>HTTP/2</code> 把 <code>HTTP</code> 协议通信的基本单位缩小为一个一个的帧，这些帧对应着逻辑流中的消息，并行地在同一个 <code>TCP</code> 连接上双向交换消息</p>
<p><code>HTTP/2</code> 虽然可以解决请求这个粒度的阻塞，但 <code>HTTP/2</code> 的基础 <code>TCP</code> 协议本身却也存在着队头阻塞的问题，<code>HTTP/2</code> 的每个请求都会被拆分成多个 <code>Frame</code>，不同请求的 <code>Frame</code> 组合成 <code>Stream</code>，<code>Stream</code> 是 <code>TCP</code> 上的逻辑传输单元，这样 <code>HTTP/2</code> 就达到了一条连接同时发送多条请求的目标，这就是多路复用的原理</p>
<p>我们看一个例子，在一条 <code>TCP</code> 连接上同时发送 <code>4</code> 个 <code>Stream</code>，其中 <code>Stream1</code> 已正确送达，<code>Stream2</code> 中的第 <code>3</code> 个 <code>Frame</code> 丢失，<code>TCP</code> 处理数据时有严格的前后顺序，先发送的 <code>Frame</code> 要先被处理，这样就会要求发送方重新发送第 <code>3</code> 个 <code>Frame</code>，<code>Stream3</code> 和 <code>Stream4</code> 虽然已到达但却不能被处理，那么这时整条连接都被阻塞</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/12-09.png" alt></p>
<p>不仅如此，由于 <code>HTTP/2</code> 必须使用 <code>HTTPS</code>，而 <code>HTTPS</code> 使用的 <code>TLS</code> 协议也存在队头阻塞问题，<code>TLS</code> 基于 <code>Record</code> 组织数据，将一堆数据放在一起（即一个 <code>Record</code>）加密，加密完后又拆分成多个 <code>TCP</code> 包传输，一般每个 <code>Record</code> 有 <code>16K</code> 左右，包含 <code>12</code> 个 <code>TCP</code> 包，这样如果 <code>12</code> 个 <code>TCP</code> 包中有任何一个包丢失，那么整个 <code>Record</code> 都无法解密</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/12-10.png" alt></p>
<p>队头阻塞会导致 <code>HTTP/2</code> 在更容易丢包的弱网络环境下比 <code>HTTP/1.1</code> 更慢，所以就有了 <code>HTTP/3</code> 当中的 <code>QUIC</code> 协议，那么 <code>QUIC</code> 是如何解决队头阻塞问题的呢？主要有两点</p>
<ul>
<li><code>QUIC</code> 的传输单元是 <code>Packet</code>，加密单元也是 <code>Packet</code>，整个加密、传输、解密都基于 <code>Packet</code>，这样就能避免 <code>TLS</code> 的队头阻塞问题</li>
<li><code>QUIC</code> 基于 <code>UDP</code>，<code>UDP</code> 的数据包在接收端没有处理顺序，即使中间丢失一个包，也不会阻塞整条连接，其他的资源会被正常处理</li>
</ul>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/12-11.png" alt></p>
<h2 id="HTTP-数据传输"><a href="#HTTP-数据传输" class="headerlink" title="HTTP 数据传输"></a>HTTP 数据传输</h2><p>这里主要分为定长数据与不定长数据的处理，我们一个一个来看</p>
<h4 id="定长数据"><a href="#定长数据" class="headerlink" title="定长数据"></a>定长数据</h4><p>对于定长的数据包而言，发送端在发送数据的过程中，需要设置 <code>Content-Length</code>，来指明发送数据的长度，当然如果采用 <code>Gzip</code> 压缩的话，<code>Content-Length</code> 设置的就是压缩后的传输长度，另外</p>
<ul>
<li><code>Content-Length</code> 如果存在并且有效的话，则必须和消息内容的传输长度完全一致，也就是说，如果过短就会截断，过长的话，就会导致超时</li>
<li>如果采用短链接的话，直接可以通过服务器关闭连接来确定消息的传输长度</li>
<li>那么在 <code>HTTP/1.0</code> 之前的版本中，<code>Content-Length</code> 字段可有可无，因为一旦服务器关闭连接，我们就可以获取到传输数据的长度了</li>
<li>在 <code>HTTP/1.1</code> 版本中，如果是 <code>keep-alive</code> 的话，<code>chunked</code> 优先级高于 <code>Content-Length</code>，若是非 <code>keep-alive</code>，则跟前面情况一样，<code>Content-Length</code> 可有可无</li>
</ul>
<p>下面我们来看看如何设置 <code>Content-Length</code>，代码如下</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> server = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>).createServer()</span><br><span class="line"></span><br><span class="line">server.on(<span class="hljs-string">'request'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (req.url === <span class="hljs-string">'/index'</span>) &#123;</span><br><span class="line">    <span class="hljs-comment">// 设置数据类型    </span></span><br><span class="line">    res.setHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/plain'</span>)</span><br><span class="line">    res.setHeader(<span class="hljs-string">'Content-Length'</span>, <span class="hljs-number">10</span>)</span><br><span class="line">    res.write(<span class="hljs-string">`使用 Content-Length 设置传输数据形式`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="hljs-number">3000</span>, _ =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`app is running at port 3000`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="不定长数据"><a href="#不定长数据" class="headerlink" title="不定长数据"></a>不定长数据</h4><p>现在采用最多的就是 <code>HTTP/1.1</code> 版本来完成传输数据，在保存 <code>keep-alive</code> 状态下，当数据是不定长的时候，我们需要设置新的头部字段 <code>Transfer-Encoding: chunked</code>，通过 <code>chunked</code> 机制，可以完成对不定长数据的处理，但是也有需要注意的地方</p>
<ul>
<li>如果头部信息中有 <code>Transfer-Encoding</code>，优先采用 <code>Transfer-Encoding</code> 里面的方法来找到对应的长度</li>
<li>如果设置了 <code>Transfer-Encoding</code>，那么 <code>Content-Length</code> 将被忽视</li>
<li>使用长连接的话，会持续的推送动态内容</li>
</ul>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> server = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>).createServer()</span><br><span class="line"></span><br><span class="line">server.on(<span class="hljs-string">'request'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (req.url === <span class="hljs-string">'/index'</span>) &#123;</span><br><span class="line">    <span class="hljs-comment">// 设置数据类型    </span></span><br><span class="line">    res.setHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/html; charset=utf8'</span>)</span><br><span class="line">    res.setHeader(<span class="hljs-string">'Content-Length'</span>, <span class="hljs-number">10</span>)</span><br><span class="line">    res.setHeader(<span class="hljs-string">'Transfer-Encoding'</span>, <span class="hljs-string">'chunked'</span>)</span><br><span class="line">    res.write(<span class="hljs-string">`使用 Content-Length 设置传输数据形式`</span>)</span><br><span class="line">    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      res.write(<span class="hljs-string">`第一次的数据`</span>)</span><br><span class="line">    &#125;, <span class="hljs-number">1000</span>)</span><br><span class="line">    res.write(<span class="hljs-string">`----`</span>)</span><br><span class="line">    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      res.write(<span class="hljs-string">`第二次的数据`</span>)</span><br><span class="line">      res.end()</span><br><span class="line">    &#125;, <span class="hljs-number">3000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="hljs-number">3000</span>, _ =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`app is running at port 3000`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="SSL-连接断开后如何恢复"><a href="#SSL-连接断开后如何恢复" class="headerlink" title="SSL 连接断开后如何恢复"></a>SSL 连接断开后如何恢复</h2><p>一共有两种方法来恢复断开的 <code>SSL</code> 连接，一种是使用 <code>Session ID</code>，一种是 <code>Session Ticket</code></p>
<h4 id="通过-Session-ID"><a href="#通过-Session-ID" class="headerlink" title="通过 Session ID"></a>通过 Session ID</h4><p>使用 <code>Session ID</code> 的方式，每一次的会话都有一个编号，当对话中断后，下一次重新连接时，只要客户端给出这个编号，服务器如果有这个编号的记录，那么双方就可以继续使用以前的秘钥，而不用重新生成一把，目前所有的浏览器都支持这一种方法，但是这种方法有一个缺点是，<code>Session ID</code> 只能够存在一台服务器上，如果我们的请求通过负载平衡被转移到了其他的服务器上，那么就无法恢复对话</p>
<h4 id="通过-Session-Ticket"><a href="#通过-Session-Ticket" class="headerlink" title="通过 Session Ticket"></a>通过 Session Ticket</h4><p>另一种方式是 <code>Session Ticket</code> 的方式，<code>Session Ticket</code> 是服务器在上一次对话中发送给客户的，这个 <code>Ticket</code> 是加密的，只有服务器能够解密，里面包含了本次会话的信息，比如对话秘钥和加密方法等，这样不管我们的请求是否转移到其他的服务器上，当服务器将 <code>Ticket</code> 解密以后，就能够获取上次对话的信息，就不用重新生成对话秘钥了</p>
<h2 id="短轮询、长轮询和-WebSocket-间的区别"><a href="#短轮询、长轮询和-WebSocket-间的区别" class="headerlink" title="短轮询、长轮询和 WebSocket 间的区别"></a>短轮询、长轮询和 WebSocket 间的区别</h2><ul>
<li>短轮询<ul>
<li>短轮询的基本思路是，浏览器每隔一段时间向浏览器发送 <code>HTTP</code> 请求，服务器端在收到请求后，不论是否有数据更新，都直接进行响应，这种方式实现的即时通信，本质上还是浏览器发送请求，服务器接受请求的一个过程，通过让客户端不断的进行请求，使得客户端能够模拟实时地收到服务器端的数据的变化</li>
<li>优缺点<ul>
<li>优点是比较简单，易于理解</li>
<li>缺点是这种方式由于需要不断的建立 <code>HTTP</code> 连接，严重浪费了服务器端和客户端的资源，当用户增加时，服务器端的压力就会变大，这是很不合理的</li>
</ul>
</li>
</ul>
</li>
<li>长轮询<ul>
<li>长轮询的基本思路，首先由客户端向服务器发起请求，当服务器收到客户端发来的请求后，服务器端不会直接进行响应，而是先将这个请求挂起，然后判断服务器端数据是否有更新，如果有更新，则进行响应，如果一直没有数据，则到达一定的时间限制才返回，客户端 <code>JavaScript</code> 响应处理函数会在处理完服务器返回的信息后，再次发出请求，重新建立连接</li>
<li>优缺点<ul>
<li>长轮询和短轮询比起来，它的优点是明显减少了很多不必要的 <code>HTTP</code> 请求次数，相比之下节约了资源</li>
<li>长轮询的缺点在于，连接挂起也会导致资源的浪费</li>
</ul>
</li>
</ul>
</li>
<li><code>WebSocket</code><ul>
<li><code>WebSocket</code> 是 <code>HTML5</code> 定义的一个新协议，与传统的 <code>HTTP</code> 协议不同，该协议允许由服务器主动的向客户端推送信息</li>
<li>优缺点<ul>
<li>优点是 <code>WebSocket</code> 是一个全双工的协议，也就是通信双方是平等的，可以相互发送消息</li>
<li>缺点在于如果需要使用 <code>WebSocket</code> 协议，服务器端的配置比较复杂</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>至于什么是单工、半双工、全双工，区别如下表所示</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>能力</th>
</tr>
</thead>
<tbody><tr>
<td>单工</td>
<td>信息单向传送</td>
</tr>
<tr>
<td>半双工</td>
<td>信息能双向传送，但不能同时双向传送</td>
</tr>
<tr>
<td>全双工</td>
<td>信息能够同时双向传送</td>
</tr>
</tbody></table>
<h2 id="正向代理和反向代理"><a href="#正向代理和反向代理" class="headerlink" title="正向代理和反向代理"></a>正向代理和反向代理</h2><ul>
<li>正向代理，我们常说的代理也就是指正向代理，正向代理的过程，它隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，客户端请求的服务都被代理服务器代替来请求</li>
<li>反向代理，这种代理模式下，它隐藏了真实的服务端，当我们向一个网站发起请求的时候，背后可能有成千上万台服务器为我们服务，具体是哪一台，我们不清楚，我们只需要知道反向代理服务器是谁就行，而且反向代理服务器会帮我们把请求转发到真实的服务器那里去，一般而言反向代理服务器一般用来实现负载平衡</li>
</ul>
<h2 id="负载平衡的两种实现方式"><a href="#负载平衡的两种实现方式" class="headerlink" title="负载平衡的两种实现方式"></a>负载平衡的两种实现方式</h2><ul>
<li>一种是使用反向代理的方式，用户的请求都发送到反向代理服务上，然后由反向代理服务器来转发请求到真实的服务器上，以此来实现集群的负载平衡</li>
<li>另一种是 <code>DNS</code> 的方式，<code>DNS</code> 可以用于在冗余的服务器上实现负载平衡，因为现在一般的大型网站使用多台服务器提供服务，因此一个域名可能会对应多个服务器地址，当用户向网站域名请求的时候，<code>DNS</code> 服务器返回这个域名所对应的服务器 <code>IP</code> 地址的集合，但在每个回答中，会循环这些 <code>IP</code> 地址的顺序，用户一般会选择排在前面的地址发送请求，以此将用户的请求均衡的分配到各个不同的服务器上，这样来实现负载均衡</li>
</ul>
<p>但是 <code>DNS</code> 的方式有一个缺点就是，由于 <code>DNS</code> 服务器中存在缓存，所以有可能一个服务器出现故障后，域名解析仍然返回的是那个 <code>IP</code> 地址，就会造成访问的问题</p>
<h2 id="HTTP-缓存策略"><a href="#HTTP-缓存策略" class="headerlink" title="HTTP 缓存策略"></a>HTTP 缓存策略</h2><p>关于缓存策略，我们之前在 <a href="https://heptaluan.github.io/2019/11/12/HTTP/04/" target="_blank" rel="noopener">浏览器缓存机制</a> 一节当中已经详细整理过，这里我们在简单梳理一下，总的分为两种策略，即强缓存和协商缓存，下面我们一个一个来看</p>
<h4 id="强缓存"><a href="#强缓存" class="headerlink" title="强缓存"></a>强缓存</h4><p>简单总结一下</p>
<ul>
<li>强缓存有两个相关字段，<code>Expires</code> 和 <code>Cache-Control</code></li>
<li>分为两种情况，一种是发送 <code>HTTP</code> 请求，一种不需要发送</li>
<li>首先检查强缓存，这个阶段不需要发送 <code>HTTP</code> 请求，通过查找不同的字段来进行，不同的 <code>HTTP</code> 版本所以不同</li>
<li><code>HTTP/1.0</code> 版本，使用的是 <code>Expires</code>，<code>HTTP/1.1</code> 使用的是 <code>Cache-Control</code></li>
</ul>
<h6 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a>Expires</h6><p><code>Expires</code> 即过期时间，时间是相对于服务器的时间而言的，存在于服务端返回的响应头中，在这个过期时间之前可以直接从缓存里面获取数据，无需再次请求，比如下面这样</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Expires: Mon, <span class="hljs-number">29</span> Jun <span class="hljs-number">2019</span> <span class="hljs-number">11</span>:<span class="hljs-number">10</span>:<span class="hljs-number">23</span> GMT</span><br></pre></td></tr></table></figure>

<p>表示该资源在 <code>2019</code> 年 <code>7</code> 月 <code>29</code> 日 <code>11:10:23</code> 过期，过期时就会重新向服务器发起请求，但是这种方式是存在一些问题的，比如服务器的时间和浏览器的时间可能并不一致，所以 <code>HTTP/1.1</code> 提出新的字段代替它</p>
<h6 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h6><p><code>HTTP/1.1</code> 版本中，使用的就是该字段，这个字段采用的时间是过期时长，对应的是 <code>max-age</code></p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cache-Control: max-age = <span class="hljs-number">6000</span></span><br></pre></td></tr></table></figure>

<p>上面代表该资源返回后 <code>6000</code> 秒，可以直接使用缓存，还有其他一些相关指令，使用方式可以参考上文链接，这里需要注意的几点</p>
<ul>
<li>当 <code>Expires</code> 和 <code>Cache-Control</code> 同时存在时，优先考虑 <code>Cache-Control</code></li>
<li>当缓存资源失效了，也就是没有命中强缓存，接下来就进入协商缓存</li>
</ul>
<h4 id="协商缓存"><a href="#协商缓存" class="headerlink" title="协商缓存"></a>协商缓存</h4><p>强缓存失效后，浏览器在请求头中携带响应的缓存 <code>Tag</code> 来向服务器发送请求，服务器根据对应的 <code>Tag</code>，来决定是否使用缓存</p>
<p>缓存分为两种，<code>Last-Modified</code> 和 <code>ETag</code>，两者各有优势，并不存在谁对谁有绝对的优势，这点与上面所讲的强缓存当中的两个 <code>Tag</code> 有所不同</p>
<h6 id="Last-Modified"><a href="#Last-Modified" class="headerlink" title="Last-Modified"></a>Last-Modified</h6><p>这个字段表示的是最后修改时间，在浏览器第一次给服务器发送请求后，服务器会在响应头中加上这个字段，浏览器接收到后，如果再次请求，会在请求头中携带 <code>If-Modified-Since</code> 字段，这个字段的值也就是服务器传来的最后修改时间，服务器拿到请求头中的 <code>If-Modified-Since</code> 的字段后，其实会和这个服务器中该资源的最后修改时间对比</p>
<ul>
<li>如果请求头中的这个值小于最后修改时间，说明是时候更新了，返回新的资源，跟常规的 <code>HTTP</code> 请求响应的流程一样</li>
<li>否则返回 <code>304</code>，告诉浏览器直接使用缓存</li>
</ul>
<h6 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a>ETag</h6><p><code>ETag</code> 是服务器根据当前文件的内容，对文件生成唯一的标识，比如 <code>MD5</code> 算法，只要里面的内容有改动，这个值就会修改，服务器通过把响应头把该字段给浏览器，浏览器接收到 <code>ETag</code> 值，会在下次请求的时候，将这个值作为 <code>If-None-Match</code> 这个字段的内容，发给服务器</p>
<p>服务器接收到 <code>If-None-Match</code> 后，会跟服务器上该资源的 <code>ETag</code> 进行比对</p>
<ul>
<li>如果两者一样的话，直接返回 <code>304</code>，告诉浏览器直接使用缓存</li>
<li>如果不一样的话，说明内容更新了，返回新的资源，跟常规的 <code>HTTP</code> 请求响应的流程一样</li>
</ul>
<h6 id="两者对比"><a href="#两者对比" class="headerlink" title="两者对比"></a>两者对比</h6><ul>
<li>性能上，<code>Last-Modified</code> 优于 <code>ETag</code>，<code>Last-Modified</code> 记录的是时间点，而 <code>Etag</code> 需要根据文件的 <code>MD5</code> 算法生成对应的 <code>Hash</code> 值</li>
<li>精度上，<code>ETag</code> 优于 <code>Last-Modified</code>，<code>ETag</code> 按照内容给资源带上标识，能准确感知资源变化，<code>Last-Modified</code> 在某些场景并不能准确感知变化，比如<ul>
<li>编辑了资源文件，但是文件内容并没有更改，这样也会造成缓存失效</li>
<li><code>Last-Modified</code> 能够感知的单位时间是秒，如果文件在 <code>1</code> 秒内改变了多次，那么这时候的 <code>Last-Modified</code> 并没有体现出修改了</li>
</ul>
</li>
</ul>
<p>最后，如果两种方式都支持的话，服务器会优先考虑 <code>ETag</code></p>
<h4 id="缓存位置"><a href="#缓存位置" class="headerlink" title="缓存位置"></a>缓存位置</h4><p>下面我们来看看，如果考虑使用缓存的话，那么缓存的位置在哪里呢？其实浏览器缓存的位置的话，可以分为四种，优先级从高到低排列分别</p>
<ul>
<li><code>Service Worker</code></li>
<li><code>Memory Cache</code></li>
<li><code>Disk Cache</code></li>
<li><code>Push Cache</code></li>
</ul>
<h6 id="Service-Worker"><a href="#Service-Worker" class="headerlink" title="Service Worker"></a>Service Worker</h6><p><code>Service Worker</code> 的缓存与浏览器其他内建的缓存机制不同，它可以让我们自由控制缓存哪些文件、如何匹配缓存、如何读取缓存，并且缓存是持续性的</p>
<p><code>PWA</code> 的实现也是和这个有关，它借鉴了 <code>Web Worker</code> 思路，由于它脱离了浏览器的窗体，因此无法直接访问 <code>DOM</code>，它能完成的功能比如离线缓存、消息推送和网络代理，其中离线缓存就是 <code>Service Worker Cache</code></p>
<h6 id="Memory-Cache"><a href="#Memory-Cache" class="headerlink" title="Memory Cache"></a>Memory Cache</h6><p>指的是内存缓存，从效率上讲它是最快的，从存活时间来讲又是最短的，当渲染进程结束后，内存缓存也就不存在了</p>
<h6 id="Disk-Cache"><a href="#Disk-Cache" class="headerlink" title="Disk Cache"></a>Disk Cache</h6><p>存储在磁盘中的缓存，从存取效率上讲是比内存缓存慢的，优势在于存储容量和存储时长，与 <code>Memory Cache</code> 对比的话，主要的策略如下</p>
<ul>
<li>内容使用率高的话，文件优先进入磁盘</li>
<li>比较大的 <code>JavaScript</code>，<code>CSS</code> 文件会直接放入磁盘，反之放入内存</li>
</ul>
<h6 id="Push-Cache"><a href="#Push-Cache" class="headerlink" title="Push Cache"></a>Push Cache</h6><p><code>Push Cache</code>（推送缓存）是 <code>HTTP/2</code> 中的内容，当以上三种缓存都没有命中时，它才会被使用，它只在会话（<code>Session</code>）中存在，一旦会话结束就被释放，并且缓存时间也很短暂，在 <code>Chrome</code> 浏览器中只有五分钟左右</p>
<p>更多 <code>Push Cache</code> 更多内容可以参考 <a href="https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/" target="_blank" rel="noopener">HTTP/2 push is tougher than I thought</a></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li>首先检查 <code>Cache-Control</code>，看强缓存是否可用如果可用的话，直接使用</li>
<li>否则进入协商缓存，发送 <code>HTTP</code> 请求，服务器通过请求头中的 <code>If-Modified-Since</code> 或者 <code>If-None-Match</code> 字段检查资源是否更新资源更新，返回资源和 <code>200</code> 状态码</li>
<li>否则返回 <code>304</code>，直接告诉浏览器直接从缓存中去资源</li>
</ul>
<h2 id="TCP-如何保证可靠传输"><a href="#TCP-如何保证可靠传输" class="headerlink" title="TCP 如何保证可靠传输"></a>TCP 如何保证可靠传输</h2><p><code>TCP</code> 协议保证数据传输可靠性的方式主要有以下几种方式</p>
<ul>
<li>校验和，<code>TCP</code> 在发送报文之前，发送方要计算校验和，收到数据后，接收方也要计算校验和，如果校验和不相等则丢弃</li>
<li>序列号与确认应答<ul>
<li>序列号，<code>TCP</code> 传输时将每个字节的数据都进行了编号，这就是序列号</li>
<li>确认应答，<code>TCP</code> 传输的过程中，每次接收方收到数据后，都会对传输方进行确认应答，也就是发送 <code>ACK</code> 报文，这个 <code>ACK</code> 报文当中带有对应的确认序列号，告诉发送方，接收到了哪些数据，下一次的数据从哪里发</li>
<li>序列号的作用不仅仅是应答的作用，有了序列号能够将接收到的数据根据序列号排序，并且去掉重复序列号的数据，这也是 <code>TCP</code> 传输可靠性的保证之一</li>
</ul>
</li>
<li>超时重传，在 <code>TCP</code> 传输过程中，我们在发送一部分数据后，都会等待对方的 <code>ACK</code> 确认报文，如果中间出现差错，没有收到 <code>ACK</code> 报文，这时候需要启动超时重传机制，这种超时重传机制保证了 <code>TCP</code> 在网络延迟或者报文丢失下的可靠传输，超时的原因主要有以下两点<ul>
<li>接收方没有收到 <code>TCP</code> 报文段，网络延迟或者丢包</li>
<li>发送方没有收到 <code>ACK</code> 报文段，网络延迟或者 <code>ACK</code> 报文丢失</li>
</ul>
</li>
<li>连接管理，连接管理就是三次握手与四次挥手的过程</li>
<li>流量控制，流量控制的目的是让接收方来得及接收数据，这样避免了数据丢包以及网络拥塞等情况</li>
<li>拥塞控制，拥塞控制就是防止过多的数据注入到网络中，这样使网络中的路由器或者链路不至于过载（四个核心算法，慢启动、拥塞避免、快速重传和快速恢复）</li>
</ul>
<h2 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h2><p><code>TCP</code> 建立连接的过程叫做握手，握手需要在客户和服务器之间交换三个 <code>TCP</code> 报文段，也叫三报文握手</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/13-01.png" alt></p>
<ul>
<li><code>A</code> 主动打开连接，<code>B</code> 被动打开连接，<code>B</code> 先进入收听状态（<code>LISTEN</code>），<code>A</code> 打算建立 <code>TCP</code> 连接时，先向 <code>B</code> 发送连接请求报文段，其中同步位 <code>SYN = 1</code>，初始序号 <code>seq = x</code>，这个报文段不能携带数据，但是要消耗一个序号，接着 <code>A</code> 进入同步已发送状态</li>
<li><code>B</code> 收到请求报文段，如果同意建立连接，则向 <code>A</code> 发送 <code>ACK</code> 确认报文段，其中同步位 <code>SYN = 1</code>，确认号 <code>ACK = 1</code>，初始序号 <code>seq = y</code>，确认号 <code>ack = x + 1</code>（请求报文段消耗了一个序号），这个 <code>ACK</code> 报文段也不能携带数据，但是要消耗一个序号，与此同时 <code>B</code> 进入到同步收到的状态</li>
<li><code>A</code> 收到 <code>B</code> 的确认报文后，还要给 <code>B</code> 发送确认报文，其中 <code>ACK = 1</code>， <code>seq = x + 1</code>（上一个报文段的 <code>ack</code>），<code>ack = y + 1</code>（上一个报文段的 <code>seq + 1</code>，因为消耗了一个序号），这个 <code>ACK</code> 报文段可以携带数据，但是如果不携带数据则不会消耗序号，下一次 <code>A</code> 给 <code>B</code> 发送报文段的初始序号 <code>seq = 1</code>，此时 <code>A</code> 进入已建立连接的状态，<code>B</code> 收到确认后也进入已建立连接的状态</li>
</ul>
<p>这里存在一个问题，那就是为什么需要最后一次确认？</p>
<p>其实简单来说，这是防止已失效的连接请求报文段突然又传送到了 <code>B</code> 而引发错误，但是有可能出现异常情况，即 <code>A</code> 发送的连接请求并没有丢失，而是滞留了在网络中，如果在传输数据完成之后，这个请求又发到 <code>B</code> ，<code>B</code> 误以为 <code>A</code> 还要发送数据，因此发送确认报文，但是 <code>A</code> 没有运输需求，因此不予理睬，如果没有最后一次确认，<code>B</code> 一直等待 <code>A</code> 的确认，这样会造成的浪费</p>
<p>采用三报文握手，如果 <code>B</code> 没有收到 <code>A</code> 的确认，则可以知道 <code>A</code> 没有建立连接的需求，就可以避免上述这种情况</p>
<blockquote>
<p>所谓的失效的连接请求就是 <code>A</code> 第一次先发送了一个请求，但是丢失了，于是 <code>A</code> 再发送一个连接请求，重新建立连接，发送数据并释放连接</p>
</blockquote>
<h2 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h2><p>所谓的四次挥手其实也就是 <code>TCP</code> 的连接释放的过程</p>
<p><img src="https://gitee.com/heptaluan/backups/raw/master/cdn/http/13-02.png" alt></p>
<ul>
<li><code>A</code> 和 <code>B</code> 目前都处于已建立连接的状态，<code>A</code> 的应用进程向其 <code>TCP</code> 发出连接释放报文段，并停止发送数据，主动关闭 <code>TCP</code> 连接，此时 <code>FIN = 1</code>，<code>seq = u</code>，<code>u</code> 等于前面已发送的最后一个字节的序号加 <code>1</code>，这时 <code>A</code> 进入到 <code>FIN-WAIT-1</code>（终止等待 <code>1</code>）状态，等待 <code>B</code> 的确认，<code>FIN</code> 报文段即使不携带数据，也要消耗一个序号</li>
<li><code>B</code> 收到释放连接后立即发出确认，此时，<code>ACK = 1</code>，确认号是 <code>ack = u + 1</code>（前面的 <code>seq + 1</code>，因为消耗了一个序号），序号 <code>seq = v</code>，<code>v</code> 等于 <code>B</code> 前面所有已传送数据的最后一个字节的序号加 <code>1</code>，<code>B</code> 进入到 <code>CLOSE-WAIT</code>（关闭等待）状态，<code>TCP</code> 服务器进程向 <code>B</code> 的高层应用进程告知，此时 <code>A</code> 到 <code>B</code> 的连接已经释放，<code>TCP</code> 连接处于半关闭状态，但是，<code>B</code> 到 <code>A</code> 这个方向的连接尚未关闭</li>
<li><code>A</code> 收到 <code>B</code> 的确认后，就进入到 <code>FIN-WAIT-2</code>（终止等待 <code>2</code>）的状态，等待 <code>B</code> 发送连接释放报文段</li>
<li>若 <code>B</code> 已经没有数据需要发送，则应用进程通知 <code>TCP</code> 释放连接，这时 <code>B</code> 发送的报文段 <code>FIN = 1</code>，<code>ACK = 1</code>，<code>seq = w</code>（可能后面又发送了一些数据），<code>ack = u + 1</code>，并且这个报文消耗一个序号，<code>B</code> 进入到 <code>LAST-ACK</code>（最后确认）的状态，等待 <code>A</code> 的确认</li>
<li><code>A</code> 收到 <code>B</code> 的确认后，必须对此发送确认报文，该报文中 <code>ACK = 1</code>，<code>seq = u + 1</code>，<code>ack = w + 1</code>，然后进入到 <code>TIME-WAIT</code>（时间等待）状态</li>
</ul>
<blockquote>
<p>但是需要注意的是，此时 <code>TCP</code> 连接并没有完全释放，必须经过时间等待计时器设置的时间 <code>2MSL</code> 之后，<code>A</code> 才进入 <code>CLOSED</code> 状态，时间 <code>MSL</code> 叫做最大报文段寿命</p>
</blockquote>
<p>那么问题来了，为什么要等待 <code>2MSL</code> 的时间呢？主要原因有两点</p>
<ul>
<li>保证 <code>A</code> 最后发送的 <code>ACK</code> 报文段能够到达 <code>B</code>，因为这个报文可能丢失，因此 <code>B</code> 会重传最后一个确认报文段，<code>A</code> 再重新发送确认报文，并且重启计时器，直到 <code>A</code> ，<code>B</code> 都能正常进入到 <code>CLOSED</code> 状态</li>
<li>防止上面提到的已失效的连接请求报文，这段时间内，这些连接请求报文就可能在网络中消失</li>
<li>此外 <code>B</code> 要比 <code>A</code> 先进入 <code>CLOSED</code> 状态</li>
</ul>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/HTTP/">HTTP</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2020/09/20/HTTP/14/">
                <i class="level-item fa fa-chevron-left"></i>
                <span class="level-item">TCP/IP 协议</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2020/09/12/HTTP/12/">
                <span class="level-item">HTTP/3</span>
                <i class="level-item fa fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.min.js"></script>
<script>
    var gitalk = new Gitalk({
        clientID: '584b59de0d23cd48fbdd',
        clientSecret: '5554c9aab0a640015867806f438bd2e10f297e5a',
        id: '4d8be6eeca924f0e30dd68bfded199ed',
        repo: 'gitalk',
        owner: 'heptaluan',
        admin: "heptaluan"
    })
    gitalk.render('comment-container')
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <figure class="avatar image is-128x128 has-mb-6">
                            <img class="is-rounded" src="https://gitee.com/heptaluan/backups/raw/master/cdn/avatar.png" alt="heptaluan">
                        </figure>
                    
                    
                    <p class="is-size-4 is-block">
                        heptaluan
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Torches@Aimer
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>WuHan China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <!-- <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        157
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        10
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        10
                    </p>
                </div>
            </div>
        </nav> -->
        <!-- <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/ppoffice" target="_blank">
                关注我</a>
        </div> -->
        
        
    </div>
</div>
    
        
<div class="card widget" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                目录
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#HTTP-协议优缺点">
        <span class="has-mr-6">1</span>
        <span>HTTP 协议优缺点</span>
        </a></li><li>
        <a class="is-flex" href="#HTTP-协议各版本差异">
        <span class="has-mr-6">2</span>
        <span>HTTP 协议各版本差异</span>
        </a></li><li>
        <a class="is-flex" href="#队头阻塞问题">
        <span class="has-mr-6">3</span>
        <span>队头阻塞问题</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#什么是队头阻塞？">
        <span class="has-mr-6">3.1</span>
        <span>什么是队头阻塞？</span>
        </a></li><li>
        <a class="is-flex" href="#如何解决">
        <span class="has-mr-6">3.2</span>
        <span>如何解决</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#HTTP-数据传输">
        <span class="has-mr-6">4</span>
        <span>HTTP 数据传输</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#定长数据">
        <span class="has-mr-6">4.1</span>
        <span>定长数据</span>
        </a></li><li>
        <a class="is-flex" href="#不定长数据">
        <span class="has-mr-6">4.2</span>
        <span>不定长数据</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#SSL-连接断开后如何恢复">
        <span class="has-mr-6">5</span>
        <span>SSL 连接断开后如何恢复</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#通过-Session-ID">
        <span class="has-mr-6">5.1</span>
        <span>通过 Session ID</span>
        </a></li><li>
        <a class="is-flex" href="#通过-Session-Ticket">
        <span class="has-mr-6">5.2</span>
        <span>通过 Session Ticket</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#短轮询、长轮询和-WebSocket-间的区别">
        <span class="has-mr-6">6</span>
        <span>短轮询、长轮询和 WebSocket 间的区别</span>
        </a></li><li>
        <a class="is-flex" href="#正向代理和反向代理">
        <span class="has-mr-6">7</span>
        <span>正向代理和反向代理</span>
        </a></li><li>
        <a class="is-flex" href="#负载平衡的两种实现方式">
        <span class="has-mr-6">8</span>
        <span>负载平衡的两种实现方式</span>
        </a></li><li>
        <a class="is-flex" href="#HTTP-缓存策略">
        <span class="has-mr-6">9</span>
        <span>HTTP 缓存策略</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#强缓存">
        <span class="has-mr-6">9.1</span>
        <span>强缓存</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Expires">
        <span class="has-mr-6">9.1.1</span>
        <span>Expires</span>
        </a></li><li>
        <a class="is-flex" href="#Cache-Control">
        <span class="has-mr-6">9.1.2</span>
        <span>Cache-Control</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#协商缓存">
        <span class="has-mr-6">9.2</span>
        <span>协商缓存</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Last-Modified">
        <span class="has-mr-6">9.2.1</span>
        <span>Last-Modified</span>
        </a></li><li>
        <a class="is-flex" href="#ETag">
        <span class="has-mr-6">9.2.2</span>
        <span>ETag</span>
        </a></li><li>
        <a class="is-flex" href="#两者对比">
        <span class="has-mr-6">9.2.3</span>
        <span>两者对比</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#缓存位置">
        <span class="has-mr-6">9.3</span>
        <span>缓存位置</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Service-Worker">
        <span class="has-mr-6">9.3.1</span>
        <span>Service Worker</span>
        </a></li><li>
        <a class="is-flex" href="#Memory-Cache">
        <span class="has-mr-6">9.3.2</span>
        <span>Memory Cache</span>
        </a></li><li>
        <a class="is-flex" href="#Disk-Cache">
        <span class="has-mr-6">9.3.3</span>
        <span>Disk Cache</span>
        </a></li><li>
        <a class="is-flex" href="#Push-Cache">
        <span class="has-mr-6">9.3.4</span>
        <span>Push Cache</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#总结">
        <span class="has-mr-6">9.4</span>
        <span>总结</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#TCP-如何保证可靠传输">
        <span class="has-mr-6">10</span>
        <span>TCP 如何保证可靠传输</span>
        </a></li><li>
        <a class="is-flex" href="#三次握手">
        <span class="has-mr-6">11</span>
        <span>三次握手</span>
        </a></li><li>
        <a class="is-flex" href="#四次挥手">
        <span class="has-mr-6">12</span>
        <span>四次挥手</span>
        </a></li></ul>
        </div>
    </div>
</div>

    
        


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Angular/">
            <span class="level-start">
                <span class="level-item">Angular</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">16</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/CSS/">
            <span class="level-start">
                <span class="level-item">CSS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">16</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Essay/">
            <span class="level-start">
                <span class="level-item">Essay</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">31</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/HTML/">
            <span class="level-start">
                <span class="level-item">HTML</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/HTTP/">
            <span class="level-start">
                <span class="level-item">HTTP</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">11</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JavaScript/">
            <span class="level-start">
                <span class="level-item">JavaScript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">48</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Node-js/">
            <span class="level-start">
                <span class="level-item">Node.js</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">16</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/React/">
            <span class="level-start">
                <span class="level-item">React</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">10</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Vue/">
            <span class="level-start">
                <span class="level-item">Vue</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/jQuery/">
            <span class="level-start">
                <span class="level-item">jQuery</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/Angular/" style="font-size: 16.67px;">Angular</a> <a href="/tags/CSS/" style="font-size: 16.67px;">CSS</a> <a href="/tags/Essay/" style="font-size: 18.33px;">Essay</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 15px;">HTTP</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/Node-js/" style="font-size: 16.67px;">Node.js</a> <a href="/tags/React/" style="font-size: 13.33px;">React</a> <a href="/tags/Vue/" style="font-size: 11.67px;">Vue</a> <a href="/tags/jQuery/" style="font-size: 11.67px;">jQuery</a>
    </div>
</div>

    
    
        <div class="column-right-shadow  ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2020/09/20/HTTP/14/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/14.jpg" alt="TCP/IP 协议">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-09-19T16:00:00.000Z">2020-09-20</time></div>
                    <a href="/2020/09/20/HTTP/14/" class="has-link-black-ter is-size-6">TCP/IP 协议</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HTTP/">HTTP</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/09/19/HTTP/13/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/13.jpg" alt="HTTP 查漏补缺">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-09-18T16:00:00.000Z">2020-09-19</time></div>
                    <a href="/2020/09/19/HTTP/13/" class="has-link-black-ter is-size-6">HTTP 查漏补缺</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HTTP/">HTTP</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/09/12/HTTP/12/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/12.jpg" alt="HTTP/3">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-09-11T16:00:00.000Z">2020-09-12</time></div>
                    <a href="/2020/09/12/HTTP/12/" class="has-link-black-ter is-size-6">HTTP/3</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HTTP/">HTTP</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/09/06/HTTP/11/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/11.jpg" alt="HTTP/2">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-09-05T16:00:00.000Z">2020-09-06</time></div>
                    <a href="/2020/09/06/HTTP/11/" class="has-link-black-ter is-size-6">HTTP/2</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HTTP/">HTTP</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/09/01/HTTP/10/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://gitee.com/heptaluan/backups/raw/master/cdn/cover/10.jpg" alt="HTTP 协议">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-08-31T16:00:00.000Z">2020-09-01</time></div>
                    <a href="/2020/09/01/HTTP/10/" class="has-link-black-ter is-size-6">HTTP 协议</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HTTP/">HTTP</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/09/">
                <span class="level-start">
                    <span class="level-item">九月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/08/">
                <span class="level-start">
                    <span class="level-item">八月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">七月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/06/">
                <span class="level-start">
                    <span class="level-item">六月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">五月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">四月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">三月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">二月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">一月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">十月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">九月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">八月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">六月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/10/">
                <span class="level-start">
                    <span class="level-item">十月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">九月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">七月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">四月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">三月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">十月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">八月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">七月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">六月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">五月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">四月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">三月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">二月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">十月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Angular/">
                        <span class="tag">Angular</span>
                        <span class="tag is-grey">16</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CSS/">
                        <span class="tag">CSS</span>
                        <span class="tag is-grey">16</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Essay/">
                        <span class="tag">Essay</span>
                        <span class="tag is-grey">31</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HTML/">
                        <span class="tag">HTML</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HTTP/">
                        <span class="tag">HTTP</span>
                        <span class="tag is-grey">11</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JavaScript/">
                        <span class="tag">JavaScript</span>
                        <span class="tag is-grey">48</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Node-js/">
                        <span class="tag">Node.js</span>
                        <span class="tag is-grey">16</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/React/">
                        <span class="tag">React</span>
                        <span class="tag is-grey">10</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Vue/">
                        <span class="tag">Vue</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jQuery/">
                        <span class="tag">jQuery</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <!-- <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="HTTP 查漏补缺" height="28">
                
                </a> -->
                <p class="is-size-7">
                &copy; 2016 - 2020
                Made with ✿  heptaluan&nbsp;
                
                </p>
            </div>
            <!-- <div class="level-end">
            
            </div> -->
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fa fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>