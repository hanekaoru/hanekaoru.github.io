<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>session 和 cookie - heptaluan&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="这篇在跟着学习 node-lessons 过程中遇到的一些问题整合而成">
<meta name="keywords" content="HTTP">
<meta property="og:type" content="article">
<meta property="og:title" content="session 和 cookie">
<meta property="og:url" content="http://yoursite.com/2017/11/26/HTTP/02/index.html">
<meta property="og:site_name" content="heptaluan&#39;s blog">
<meta property="og:description" content="这篇在跟着学习 node-lessons 过程中遇到的一些问题整合而成">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/02.jpg">
<meta property="og:updated_time" content="2019-08-14T03:57:08.418Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="session 和 cookie">
<meta name="twitter:description" content="这篇在跟着学习 node-lessons 过程中遇到的一些问题整合而成">
<meta name="twitter:image" content="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/02.jpg">







<link rel="icon" href="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/favicon.ico">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <!-- <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="session 和 cookie" height="28">
            
            </a>
        </div> -->
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">Home</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/heptaluan">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main"><div class="card">
    
    <div class="card-image">
        <span class="image is-7by1">
            <img class="thumbnail" src="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/02.jpg" alt="session 和 cookie">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <div class="level-item has-text-grey">2017-11-26</div>
                <!-- <time class="level-item has-text-grey" datetime="2017-11-25T16:00:00.000Z">2017-11-26</time> -->
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/HTTP/">HTTP</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    22 分钟 读完 (大约 3228 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                session 和 cookie
            
        </h1>
        <div class="content">
            <p>这篇在跟着学习 <a href="https://github.com/zhangsan/node-lessons" target="_blank" rel="noopener">node-lessons</a> 过程中遇到的一些问题整合而成</p>
<a id="more"></a>

<p>众所周知，<code>http</code> 是一个无状态协议，所以客户端每次发出请求时，下一次请求无法得知上一次请求所包含的状态数据，如何能把一个用户的状态数据关联起来呢？</p>
<p>比如在某个页面中，你进行了登陆操作，而当你跳转到商品页时，服务端如何知道你是已经登陆的状态？</p>
<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p>首先产生了 <code>cookie</code> 这门技术来解决这个问题，<code>cookie</code> 是 <code>http</code> 协议的一部分，它的处理分为如下几步</p>
<ul>
<li><p>服务器向客户端发送 <code>cookie</code></p>
<ul>
<li><p>常使用 <code>http</code> 协议规定的 <code>set-cookie</code> 头操作</p>
</li>
<li><p>规范规定 <code>cookie</code> 的格式为 <code>name = value</code> 格式，且必须包含这部分</p>
</li>
</ul>
</li>
<li><p>浏览器将 <code>cookie</code> 保存</p>
</li>
<li><p>每次请求浏览器都会将 <code>cookie</code> 发向服务器</p>
</li>
</ul>
<p>其他可选的 <code>cookie</code> 参数会影响将 <code>cookie</code> 发送给服务器端的过程，主要有以下几种</p>
<ul>
<li><p><code>path</code>：表示 <code>cookie</code> 影响到的路径，匹配该路径才发送这个 <code>cookie</code></p>
</li>
<li><p><code>expires</code> 和 <code>maxAge</code>：告诉浏览器这个 <code>cookie</code> 什么时候过期，<code>expires</code> 是 <code>UTC</code> 格式时间，<code>maxAge</code> 是 <code>cookie</code> 多久后过期的相对时间，当不设置这两个选项时，会产生 <code>session cookie</code>，<code>session cookie</code> 是 <code>transient</code> 的，当用户关闭浏览器时，就被清除，一般用来保存 <code>session</code> 的 <code>session_id</code></p>
</li>
<li><p><code>secure</code>：当 <code>secure</code> 值为 <code>true</code> 时，<code>cookie</code> 在 <code>http</code> 中是无效，在 <code>HTTPS</code> 中才有效</p>
</li>
<li><p><code>httpOnly</code>：浏览器不允许脚本操作 <code>document.cookie</code> 去更改 <code>cookie</code>，一般情况下都应该设置这个为 <code>true</code>，这样可以避免被 <code>xss</code> 攻击拿到 <code>cookie</code></p>
</li>
</ul>
<h2 id="express-中的-cookie"><a href="#express-中的-cookie" class="headerlink" title="express 中的 cookie"></a>express 中的 cookie</h2><p><code>express</code> 在 <code>4.x</code> 版本之后，<code>session</code> 管理和 <code>cookies</code> 等许多模块都<strong>不再</strong>直接包含在 <code>express</code> 中，而是需要单独添加相应模块</p>
<p><code>express4</code> 中操作 <code>cookie</code> 使用 <a href="https://github.com/expressjs/cookie-parser" target="_blank" rel="noopener">cookie-parser</a> 模块</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 首先引入 cookie-parser 这个模块</span></span><br><span class="line"><span class="hljs-keyword">var</span> cookieParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cookie-parser'</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> app = express();</span><br><span class="line">app.listen(<span class="hljs-number">3000</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 使用 cookieParser 中间件，cookieParser(secret, options)</span></span><br><span class="line"><span class="hljs-comment">// 其中 secret 用来加密 cookie 字符串（下面会提到 signedCookies）</span></span><br><span class="line"><span class="hljs-comment">// options 传入上面介绍的 cookie 可选参数</span></span><br><span class="line">app.use(cookieParser());</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// 如果请求中的 cookie 存在 isVisit, 则输出 cookie</span></span><br><span class="line">  <span class="hljs-comment">// 否则，设置 cookie 字段 isVisit, 并设置过期时间为1分钟</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (req.cookies.isVisit) &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(req.cookies);</span><br><span class="line">    res.send(<span class="hljs-string">'再次欢迎访问'</span>);</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    res.cookie(<span class="hljs-string">'isVisit'</span>, <span class="hljs-number">1</span>, &#123; <span class="hljs-attr">maxAge</span>: <span class="hljs-number">60</span> * <span class="hljs-number">1000</span> &#125;);</span><br><span class="line">    res.send(<span class="hljs-string">'欢迎第一次访问'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><p><code>cookie</code> 虽然很方便，但是使用 <code>cookie</code> 有一个很大的弊端，<code>cookie</code> 中的所有数据在客户端就可以被修改，数据非常容易被伪造</p>
<p>那么一些重要的数据就不能存放在 <code>cookie</code> 中了，而且如果 <code>cookie</code> 中数据字段太多会影响传输效率</p>
<p>为了解决这些问题，就产生了 <code>session</code>，<code>session</code> 中的数据是保留在服务器端的</p>
<p><code>session</code> 的运作通过一个 <code>session_id</code> 来进行，<code>session_id</code> 通常是存放在客户端的 <code>cookie</code> 中，比如在 <code>express</code> 中，默认是 <code>connect.sid</code> 这个字段</p>
<p>当请求到来时，服务端检查 <code>cookie</code> 中保存的 <code>session_id</code> 并通过这个 <code>session_id</code> 与服务器端的 <code>session data</code> 关联起来，进行数据的保存和修改</p>
<p>这意思就是说，当你浏览一个网页时，服务端随机产生一个 <code>1024</code> 比特长的字符串，然后存在你 <code>cookie</code> 中的 <code>connect.sid</code> 字段中</p>
<p>当你下次访问时，<code>cookie</code> 会带有这个字符串，然后浏览器就知道你是上次访问过的某某某，然后从服务器的存储中取出上次记录在你身上的数据</p>
<p>由于字符串是随机产生的，而且位数足够多，所以也不担心有人能够伪造，伪造成功的概率比坐在家里编程时被邻居家的狗突然闯入并咬死的几率还低</p>
<p><code>session</code> 可以存放在内存、<code>cookie</code> 本身、<code>redis</code> 或 <code>memcached</code> 等缓存中，或者放置于数据库中</p>
<p>线上来说，缓存的方案比较常见，存数据库的话，查询效率相比前三者都太低，不推荐；<code>cookie session</code> 有安全性问题，下面会提到</p>
<p><code>express</code> 中操作 <code>session</code> 要用到 <a href="https://github.com/expressjs/session" target="_blank" rel="noopener">express-session</a> 这个模块</p>
<p>主要的方法就是 <code>session(options)</code>，其中 <code>options</code> 中包含可选参数，主要有</p>
<ol>
<li><p><code>name</code>：设置 <code>cookie</code> 中，保存 <code>session</code> 的字段名称，默认为 <code>connect.sid</code> </p>
</li>
<li><p><code>store</code>：<code>session</code> 的存储方式，默认存放在内存中，也可以使用 <code>redis</code>，<code>mongodb</code> 等，<code>express</code> 生态中都有相应模块的支持</p>
</li>
<li><p><code>secret</code>：通过设置的 <code>secret</code> 字符串，来计算 <code>hash</code> 值并放在 <code>cookie</code> 中，使产生的 <code>signedCookie</code> 防篡改</p>
</li>
<li><p><code>cookie</code>：设置存放 <code>session id</code> 的 <code>cookie</code> 的相关选项，默认为 (<code>default: { path: &#39;/&#39;, httpOnly: true, secure: false, maxAge: null }</code>)</p>
</li>
<li><p><code>genid</code>：产生一个新的 <code>session_id</code> 时，所使用的函数， 默认使用 <code>uid2</code> 这个 <code>npm</code> 包</p>
</li>
<li><p><code>rolling</code>：每个请求都重新设置一个 <code>cookie</code>，默认为 <code>false</code></p>
</li>
<li><p><code>resave</code>：即使 <code>session</code> 没有被修改，也保存 <code>session</code> 值，默认为 <code>true</code></p>
</li>
</ol>
<h2 id="在内存中存储-session"><a href="#在内存中存储-session" class="headerlink" title="在内存中存储 session"></a>在内存中存储 session</h2><p><code>express-session</code> 默认使用内存来存 <code>session</code>，对于开发调试来说很方便</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 首先引入 express-session 这个模块</span></span><br><span class="line"><span class="hljs-keyword">var</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express-session'</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> app = express();</span><br><span class="line">app.listen(<span class="hljs-number">5000</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// 按照上面的解释，设置 session 的可选参数</span></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  secret: <span class="hljs-string">'recommand 128 bytes random string'</span>, <span class="hljs-comment">// 建议使用 128 个字符的随机字符串</span></span><br><span class="line">  cookie: &#123; <span class="hljs-attr">maxAge</span>: <span class="hljs-number">60</span> * <span class="hljs-number">1000</span> &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// 检查 session 中的 isVisit 字段</span></span><br><span class="line">  <span class="hljs-comment">// 如果存在则增加一次，否则为 session 设置 isVisit 字段，并初始化为 1</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (req.session.isVisit) &#123;</span><br><span class="line">    req.session.isVisit++;</span><br><span class="line">    res.send(<span class="hljs-string">'&lt;p&gt;第 '</span> + req.session.isVisit + <span class="hljs-string">'次来此页面&lt;/p&gt;'</span>);</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    req.session.isVisit = <span class="hljs-number">1</span>;</span><br><span class="line">    res.send(<span class="hljs-string">'欢迎第一次来这里'</span>);</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(req.session);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="在-redis-中存储-session"><a href="#在-redis-中存储-session" class="headerlink" title="在 redis 中存储 session"></a>在 redis 中存储 session</h2><p><code>session</code> 存放在内存中不方便进程间共享，因此可以使用 <code>redis</code> 等缓存来存储 <code>session</code></p>
<p>假设你的机器是 <code>4</code> 核的，你使用了 <code>4</code> 个进程在跑同一个 <code>node web</code> 服务，当用户访问进程 <code>1</code> 时，他被设置了一些数据当做 <code>session</code> 存在内存中，而下一次访问时，他被负载均衡到了进程 <code>2</code>，则此时进程 <code>2</code> 的内存中没有他的信息，认为他是个新用户，这就会导致用户在我们服务中的状态不一致</p>
<p>使用 <code>redis</code> 作为缓存，可以使用 <a href="https://github.com/tj/connect-redis" target="_blank" rel="noopener">connect-redis</a> 模块来得到 <code>redis</code> 连接实例，然后在 <code>session</code> 中设置存储方式为该实例</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);</span><br><span class="line"><span class="hljs-keyword">var</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express-session'</span>);</span><br><span class="line"><span class="hljs-keyword">var</span> redisStore = <span class="hljs-built_in">require</span>(<span class="hljs-string">'connect-redis'</span>)(session);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> app = express();</span><br><span class="line">app.listen(<span class="hljs-number">5000</span>);</span><br><span class="line"></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  <span class="hljs-comment">// 假如你不想使用 redis 而想要使用 memcached 的话，代码改动也不会超过 5 行</span></span><br><span class="line">  <span class="hljs-comment">// 这些 store 都遵循着统一的接口，凡是实现了那些接口的库，都可以作为 session 的 store 使用</span></span><br><span class="line">  <span class="hljs-comment">// 比如都需要实现 .get(keyString) 和 .set(keyString, value) 方法</span></span><br><span class="line">  <span class="hljs-comment">// 编写自己的 store 也很简单</span></span><br><span class="line">  store: <span class="hljs-keyword">new</span> redisStore(),</span><br><span class="line">  secret: <span class="hljs-string">'somesecrettoken'</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (req.session.isVisit) &#123;</span><br><span class="line">    req.session.isVisit++;</span><br><span class="line">    res.send(<span class="hljs-string">'&lt;p&gt;第 '</span> + req.session.isVisit + <span class="hljs-string">'次来到此页面&lt;/p&gt;'</span>);</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    req.session.isVisit = <span class="hljs-number">1</span>;</span><br><span class="line">    res.send(<span class="hljs-string">'欢迎第一次来这里'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们可以运行 <code>redis-cli</code> 查看结果，如图可以看到 <code>redis</code> 中缓存结果</p>
<p><img src="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/http/08.png" alt></p>
<h2 id="各种存储的利弊"><a href="#各种存储的利弊" class="headerlink" title="各种存储的利弊"></a>各种存储的利弊</h2><p>上面我们说到，<code>session</code> 的 <code>store</code> 有四个常用选项：</p>
<ol>
<li><p>内存</p>
</li>
<li><p><code>cookie</code></p>
</li>
<li><p>缓存 </p>
</li>
<li><p>数据库</p>
</li>
</ol>
<p>其中，开发环境存内存就好了，一般的小程序为了省事，如果不涉及状态共享的问题，用内存 <code>session</code> 也没问题，但内存 <code>session</code> 除了省事之外，没有别的好处</p>
<p><code>cookie session</code> 我们下面会提到，现在说说利弊，用 <code>cookie session</code> 的话，是不用担心状态共享问题的，因为 <code>session</code> 的 <code>data</code> 不是由服务器来保存，而是保存在用户浏览器端，每次用户访问时，都会主动带上他自己的信息，当然在这里，安全性之类的，只要遵照最佳实践来，也是有保证的，它的弊端是增大了数据量传输，利端是方便</p>
<p>缓存方式是最常用的方式了，即快，又能共享状态，相比 <code>cookie session</code> 来说，当 <code>session data</code> 比较大的时候，可以节省网络传输，推荐使用</p>
<p>数据库 <code>session</code>，除非你很熟悉这一块，知道自己要什么，否则还是老老实实用缓存吧</p>
<h2 id="signedCookie"><a href="#signedCookie" class="headerlink" title="signedCookie"></a>signedCookie</h2><p><code>cookie</code> 虽然很方便，但是使用 <code>cookie</code> 有一个很大的弊端，<code>cookie</code> 中的所有数据在客户端就可以被修改，数据非常容易被伪造</p>
<p>其实不是这样的，那只是为了方便理解才那么写，要知道，计算机领域有个名词叫<strong>签名</strong>，专业点说，叫<strong>信息摘要算法</strong></p>
<p>比如我们现在面临着一个菜鸟开发的网站，他用 <code>cookie</code> 来记录登陆的用户凭证，相应的 <code>cookie</code> 长这样： <code>dotcom_user=zhangsan</code>，它说明现在的用户是 <code>zhangsan</code> 这个用户，如果我在浏览器中装个插件，把它改成 <code>dotcom_user=lisi</code>，服务器一读取，就会误认为我是 <code>lisi</code>，然后我就可以进行 <code>lisi</code> 才能进行的操作了</p>
<p>OK，现在我有一些数据，不想存在 <code>session</code> 中，想存在 <code>cookie</code> 中，怎么保证不被篡改呢？答案很简单，签个名</p>
<p>假设我的服务器有个秘密字符串，是 <code>this_is_my_secret_and_fuck_you_all</code>，我为用户 <code>cookie</code> 的 <code>dotcom_user</code> 字段设置了个值 <code>zhangsan</code></p>
<p><code>cookie</code> 本应是</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="hljs-attr">dotcom_user</span>: <span class="hljs-string">'zhangsan'</span> &#125;</span><br></pre></td></tr></table></figure>

<p>这样的，而如果我们签个名，比如把 <code>dotcom_user</code> 的值跟我的 <code>secret_string</code> 做个 <code>sha1</code></p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha1(<span class="hljs-string">'this_is_my_secret_and_fuck_you_all'</span> + <span class="hljs-string">'zhangsan'</span>) === <span class="hljs-string">'4850a42e3bc0d39c978770392cbd8dc2923e3d1d'</span></span><br></pre></td></tr></table></figure>

<p>然后把 <code>cookie</code> 变成这样</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  dotcom_user: <span class="hljs-string">'zhangsan'</span>,</span><br><span class="line">  <span class="hljs-string">'dotcom_user.sig'</span>: <span class="hljs-string">'4850a42e3bc0d39c978770392cbd8dc2923e3d1d'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样一来，用户就没法伪造信息了，一旦它更改了 <code>cookie</code> 中的信息，则服务器会发现 <code>hash</code> 校验的不一致</p>
<p>毕竟他不懂我们的 <code>secret_string</code> 是什么，而暴力破解哈希值的成本太高</p>
<h2 id="cookie-session"><a href="#cookie-session" class="headerlink" title="cookie-session"></a>cookie-session</h2><p><code>cookie-session</code> 的实现跟 <code>signedCookies</code> 差不多</p>
<p>不过 <code>cookie-session</code> 我个人建议不要使用，有受到回放攻击的危险</p>
<p>回放攻击指的是，比如一个用户，它现在有 <code>100</code> 积分，积分存在 <code>session</code> 中，<code>session</code> 保存在 <code>cookie</code> 中，他先复制下现在的这段 <code>cookie</code>，然后去发个帖子，扣掉了 <code>20</code> 积分，于是他就只有 <code>80</code> 积分了，而他现在可以将之前复制下的那段 <code>cookie</code> 再粘贴回去浏览器中，于是服务器在一些场景下会认为他又有了 <code>100</code> 积分</p>
<p>如果避免这种攻击呢？这就需要引入一个第三方的手段来验证 <code>cookie session</code>，而验证所需的信息，一定不能存在 <code>cookie</code> 中，这么一来，避免了这种攻击后，使用 <code>cookie session</code> 的好处就荡然无存了，如果为了避免攻击而引入了缓存使用的话，那不如把 <code>cookie session</code> 也一起放进缓存中</p>
<h2 id="session-cookie"><a href="#session-cookie" class="headerlink" title="session cookie"></a>session cookie</h2><p>初学者容易犯的一个错误是，忘记了 <code>session_id</code> 在 <code>cookie</code> 中的存储方式是 <code>session cookie</code>，即，当用户一关闭浏览器，浏览器 <code>cookie</code> 中的 <code>session_id</code> 字段就会消失</p>
<p>常见的场景就是在开发用户登陆状态保持时</p>
<p>假如用户在之前登陆了你的网站，你在他对应的 <code>session</code> 中存了信息，当他关闭浏览器再次访问时，你还是不懂他是谁，所以我们要在 <code>cookie</code> 中，也保存一份关于用户身份的信息</p>
<p>比如有这样一个用户</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="hljs-attr">username</span>: <span class="hljs-string">'zhangsan'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">22</span>, <span class="hljs-attr">company</span>: <span class="hljs-string">'baidu'</span>, <span class="hljs-attr">location</span>: <span class="hljs-string">'beijing'</span> &#125;</span><br></pre></td></tr></table></figure>

<p>我们可以考虑把这四个字段的信息都存在 <code>session</code> 中，而在 <code>cookie</code>，我们用 <code>signedCookies</code> 来存个 <code>username</code></p>
<p>登陆的检验过程伪代码如下</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (req.session.user) &#123;</span><br><span class="line">  <span class="hljs-comment">// 获取 user 并进行下一步</span></span><br><span class="line">  next()</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (req.signedCookies[<span class="hljs-string">'username'</span>]) &#123;</span><br><span class="line">  <span class="hljs-comment">// 如果存在则从数据库中获取这个 username 的信息，并保存到 session 中</span></span><br><span class="line">  getuser(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, user</span>) </span>&#123;</span><br><span class="line">    req.session.user = user;</span><br><span class="line">    next();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">  <span class="hljs-comment">// 当做为登陆用户处理</span></span><br><span class="line">  next();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/HTTP/">HTTP</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2017/12/01/HTTP/03/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">域名发散与收敛</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2017/11/11/CSS/10/">
                <span class="level-item">link 和 @import 的区别</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.min.js"></script>
<script>
    var gitalk = new Gitalk({
        clientID: '584b59de0d23cd48fbdd',
        clientSecret: '5554c9aab0a640015867806f438bd2e10f297e5a',
        id: '5f5519ba77439f247f5b2c43c8318d72',
        repo: 'gitalk',
        owner: 'heptaluan',
        admin: "heptaluan"
    })
    gitalk.render('comment-container')
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <figure class="image is-128x128 has-mb-6">
                            <img class="is-rounded" src="https://avatars2.githubusercontent.com/u/18285736?s=460&amp;v=4" alt="heptaluan">
                        </figure>
                    
                    
                    <p class="is-size-4 is-block">
                        heptaluan
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        GALLOWS BELL.
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>WuHan China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <!-- <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        143
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        10
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        10
                    </p>
                </div>
            </div>
        </nav> -->
        <!-- <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/ppoffice" target="_blank">
                关注我</a>
        </div> -->
        
        
    </div>
</div>
    
        
<div class="card widget" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                目录
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#cookie">
        <span class="has-mr-6">1</span>
        <span>cookie</span>
        </a></li><li>
        <a class="is-flex" href="#express-中的-cookie">
        <span class="has-mr-6">2</span>
        <span>express 中的 cookie</span>
        </a></li><li>
        <a class="is-flex" href="#session">
        <span class="has-mr-6">3</span>
        <span>session</span>
        </a></li><li>
        <a class="is-flex" href="#在内存中存储-session">
        <span class="has-mr-6">4</span>
        <span>在内存中存储 session</span>
        </a></li><li>
        <a class="is-flex" href="#在-redis-中存储-session">
        <span class="has-mr-6">5</span>
        <span>在 redis 中存储 session</span>
        </a></li><li>
        <a class="is-flex" href="#各种存储的利弊">
        <span class="has-mr-6">6</span>
        <span>各种存储的利弊</span>
        </a></li><li>
        <a class="is-flex" href="#signedCookie">
        <span class="has-mr-6">7</span>
        <span>signedCookie</span>
        </a></li><li>
        <a class="is-flex" href="#cookie-session">
        <span class="has-mr-6">8</span>
        <span>cookie-session</span>
        </a></li><li>
        <a class="is-flex" href="#session-cookie">
        <span class="has-mr-6">9</span>
        <span>session cookie</span>
        </a></li></ul>
        </div>
    </div>
</div>

    
        


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Angular/">
            <span class="level-start">
                <span class="level-item">Angular</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">16</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/CSS/">
            <span class="level-start">
                <span class="level-item">CSS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">11</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Essay/">
            <span class="level-start">
                <span class="level-item">Essay</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/HTTP/">
            <span class="level-start">
                <span class="level-item">HTTP</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JavaScript/">
            <span class="level-start">
                <span class="level-item">JavaScript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">57</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/MySQL/">
            <span class="level-start">
                <span class="level-item">MySQL</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Node-js/">
            <span class="level-start">
                <span class="level-item">Node.js</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/React/">
            <span class="level-start">
                <span class="level-item">React</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">14</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Vue/">
            <span class="level-start">
                <span class="level-item">Vue</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">14</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/jQuery/">
            <span class="level-start">
                <span class="level-item">jQuery</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">9</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/Angular/" style="font-size: 18.57px;">Angular</a> <a href="/tags/CSS/" style="font-size: 15.71px;">CSS</a> <a href="/tags/Essay/" style="font-size: 10px;">Essay</a> <a href="/tags/HTTP/" style="font-size: 11.43px;">HTTP</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/MySQL/" style="font-size: 11.43px;">MySQL</a> <a href="/tags/Node-js/" style="font-size: 12.86px;">Node.js</a> <a href="/tags/React/" style="font-size: 17.14px;">React</a> <a href="/tags/Vue/" style="font-size: 17.14px;">Vue</a> <a href="/tags/jQuery/" style="font-size: 14.29px;">jQuery</a>
    </div>
</div>

    
    
        <div class="column-right-shadow  ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/08/04/CSS/11/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/11.jpg" alt="px，em，rem，vw 和 vh">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-03T16:00:00.000Z">2019-08-04</time></div>
                    <a href="/2019/08/04/CSS/11/" class="has-link-black-ter is-size-6">px，em，rem，vw 和 vh</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/CSS/">CSS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/02/JavaScript/57/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/57.jpg" alt="JavaScript 中一些常用方法的实现">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-01T16:00:00.000Z">2019-08-02</time></div>
                    <a href="/2019/08/02/JavaScript/57/" class="has-link-black-ter is-size-6">JavaScript 中一些常用方法的实现</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JavaScript/">JavaScript</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/22/Angular/16/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/16.jpg" alt="Angular 中的变化检测机制">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-21T16:00:00.000Z">2019-07-22</time></div>
                    <a href="/2019/07/22/Angular/16/" class="has-link-black-ter is-size-6">Angular 中的变化检测机制</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Angular/">Angular</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/13/JavaScript/56/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/56.jpg" alt="迭代协议与生成器">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-12T16:00:00.000Z">2019-07-13</time></div>
                    <a href="/2019/07/13/JavaScript/56/" class="has-link-black-ter is-size-6">迭代协议与生成器</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JavaScript/">JavaScript</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/11/Angular/13/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://raw.githubusercontent.com/heptaluan/blog/master/backups/cdn/cover/13.jpg" alt="Angular 中路由传递参数的几种方式">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-10T16:00:00.000Z">2019-07-11</time></div>
                    <a href="/2019/07/11/Angular/13/" class="has-link-black-ter is-size-6">Angular 中路由传递参数的几种方式</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Angular/">Angular</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">八月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">六月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">九月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">七月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">四月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">三月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">十月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">八月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">七月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">六月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">五月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">四月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">三月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">二月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Angular/">
                        <span class="tag">Angular</span>
                        <span class="tag is-grey">16</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CSS/">
                        <span class="tag">CSS</span>
                        <span class="tag is-grey">11</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Essay/">
                        <span class="tag">Essay</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HTTP/">
                        <span class="tag">HTTP</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JavaScript/">
                        <span class="tag">JavaScript</span>
                        <span class="tag is-grey">57</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MySQL/">
                        <span class="tag">MySQL</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Node-js/">
                        <span class="tag">Node.js</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/React/">
                        <span class="tag">React</span>
                        <span class="tag is-grey">14</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Vue/">
                        <span class="tag">Vue</span>
                        <span class="tag is-grey">14</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jQuery/">
                        <span class="tag">jQuery</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <!-- <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="session 和 cookie" height="28">
                
                </a> -->
                <p class="is-size-7">
                &copy; 2016 - 2019
                Made with ✿  heptaluan&nbsp;
                
                </p>
            </div>
            <!-- <div class="level-end">
            
            </div> -->
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>